---
title: "hw2"
output: html_document
date: "2025-09-28"
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(janitor)
library(dplyr)
```

# Problem 1
## Clean_pm
```{r clean_pm}
pols = read_csv("./data/pols-month.csv")

pols = pols |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    month = month.name[month],
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem"
    )
  ) |>
  select(-day, -prez_gop, -prez_dem)
head(pols)
print(summary(pols))
glimpse(pols)

```

## Clean_snp

```{r clean_snp}
snp = read_csv("./data/snp.csv")

snp = snp |>
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    month = month.name[month]
  ) |>
  select(year, month, close) |>
  arrange(year, match(month, month.name))
head(snp)
print(summary(snp))
glimpse(snp)
```

## Unemployment clean and merge
``` {r}
# Tidy unemployment and merge all datasets
unemp = read_csv("./data/unemployment.csv") |>
  pivot_longer(cols = -Year, names_to = "month", values_to = "unemployment") |>
  mutate(
    month = month.name[match(month, month.abb)],  # convert Jan → January, etc.
    year = Year
  ) |>
  select(year, month, unemployment)

merged_df = pols |>
  left_join(snp, by = c("year", "month")) |>
  left_join(unemp, by = c("year", "month"))

head(merged_df)
print(summary(merged_df))
glimpse(merged_df)
```

## descirption
The pols-month dataset has 822 rows and 9 variables covering the years 1947 to 2015. Key variables include year, month, counts of governors, senators, and representatives from each party, and an indicator for the sitting president’s party.

The snp dataset has 787 rows and 3 variables, with data spanning much of the 20th century into the early 2000s. The key variables are year, month, and the stock market closing price (close).

The unemployment dataset contains over 816 (68*12) monthly observations, with variables year, month, and the unemployment rate (unemployment).

Finally, the merged dataset joins these three sources into a single table of 822 rows and 11 variables, indexed by year and month. This combined dataset allows us to analyze relationships among political party , market performance, and unemployment across time.

# Problem 2

```{r import n clean}
# Clean Mr. Trash Wheel
mr_trash = read_excel(
  "./data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Mr. Trash Wheel",
  skip = 1
) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
    year = as.character(year),
    month = as.character(month),
    sports_balls = as.integer(round(sports_balls, 0)),
    wheel = "Mr. Trash Wheel"
  ) |>
  select(-starts_with("x"))

# Clean Professor Trash Wheel
prof_trash = read_excel(
  "./data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Professor Trash Wheel",
  skip = 1
) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
    year = as.character(year),
    month = as.character(month),
    wheel = "Professor Trash Wheel"
  ) |>
  select(-starts_with("x"))

# Clean Gwynnda
gwynnda_trash = read_excel(
  "./data/202409 Trash Wheel Collection Data.xlsx",
  sheet = "Gwynnda Trash Wheel",
  skip = 1
) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
    year = as.character(year),
    month = as.character(month),
    wheel = "Gwynnda"
  ) |>
  select(-starts_with("x"))

```

# Combine all wheels
```{r}

trash_data = bind_rows(mr_trash, prof_trash, gwynnda_trash)
prof_total_weight = trash_data |>
  filter(wheel == "Professor Trash Wheel") |>
  summarise(total_weight = sum(weight_tons, na.rm = TRUE))

gwynnda_cigs_june2022 = trash_data |>
  filter(wheel == "Gwynnda", year == "2022", month == "June") |>
  summarise(total_cigs = sum(cigarette_butts, na.rm = TRUE))

head(trash_data)
prof_total_weight
gwynnda_cigs_june2022
```
